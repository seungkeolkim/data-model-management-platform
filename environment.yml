# =============================================================================
# ML Platform - conda 환경 설정
#
# 사용법:
#   conda env create -f environment.yml
#   conda activate mlplatform
#
# 업데이트:
#   conda env update -f environment.yml --prune
# =============================================================================

name: mlplatform

channels:
  - conda-forge
  - defaults

dependencies:
  # -------------------------------------------------------------------------
  # Python
  # -------------------------------------------------------------------------
  - python=3.11

  # -------------------------------------------------------------------------
  # 빌드 도구 (conda로 설치하면 시스템 라이브러리 포함)
  # -------------------------------------------------------------------------
  - pip
  - gcc
  - libpq           # PostgreSQL 클라이언트 라이브러리

  # -------------------------------------------------------------------------
  # 이미지 처리 (conda-forge 버전이 OpenCV 의존성 처리 편함)
  # -------------------------------------------------------------------------
  - opencv          # opencv-python-headless 대신 conda 버전 사용 가능
  - pillow

  # -------------------------------------------------------------------------
  # 데이터 처리
  # -------------------------------------------------------------------------
  - numpy
  - pandas

  # -------------------------------------------------------------------------
  # pip으로 설치할 패키지 (conda에 없거나 최신 버전 필요)
  # -------------------------------------------------------------------------
  - pip:
    # Web Framework
    - fastapi>=0.111.0
    - uvicorn[standard]>=0.29.0

    # Database
    - sqlalchemy[asyncio]>=2.0.30
    - asyncpg>=0.29.0
    - psycopg2-binary>=2.9.9
    - alembic>=1.13.1

    # Validation & Settings
    - pydantic>=2.7.0
    - pydantic-settings>=2.3.0
    - python-multipart>=0.0.9

    # Task Queue
    - celery>=5.4.0
    - sqlalchemy-celery-beat>=0.9.0

    # Data
    - pycocotools>=2.0.7

    # Config & Utils
    - python-dotenv>=1.0.0
    - python-jose[cryptography]>=3.3.0
    - httpx>=0.27.0
    - tenacity>=8.3.0
    - structlog>=24.2.0

    # Dev tools
    - pytest>=8.2.0
    - pytest-asyncio>=0.23.0
    - pytest-cov>=5.0.0
    - ruff>=0.4.0
    - mypy>=1.10.0
    - pre-commit>=3.7.0
    - ipython
    - ipykernel
